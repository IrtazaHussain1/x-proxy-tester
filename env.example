# Database Configuration
# For local MySQL: mysql://USERNAME:PASSWORD@localhost:3306/DATABASE_NAME
# Example: mysql://root:yourpassword@localhost:3306/xproxy_tester
DATABASE_URL="mysql://root:root@localhost:3306/xproxy_tester"

# XProxy Portal API Configuration
XPROXY_API_URL="https://jmui.vercel.app"
XPROXY_API_ENDPOINT="/api/phones"
XPROXY_API_TOKEN="your-api-token-here"
XPROXY_API_TIMEOUT_MS=30000

# Testing Configuration
# Optimized for production (2 VCPU / 4GB RAM):
# - TEST_INTERVAL_MS: 10000 (10s) reduces CPU by 50% vs 5000ms
# - REQUEST_TIMEOUT_MS: 15000 (15s) prevents long-running requests
TEST_TARGET_URL="https://api.ipify.org?format=json"
TEST_INTERVAL_MS=10000
REQUEST_TIMEOUT_MS=15000
ROTATION_THRESHOLD=10

# Refresh Configuration
PROXY_REFRESH_INTERVAL_MS=21600000

# Stability Calculation
# Increased to 20 minutes (1200000ms) to reduce CPU usage
STABILITY_CHECK_INTERVAL_MS=1200000

# Auto-Deactivation Configuration
# Automatically deactivate proxies that start failing consistently
AUTO_DEACTIVATION_ENABLED=true
# Number of consecutive failures before auto-deactivation
AUTO_DEACTIVATION_CONSECUTIVE_FAILURES=20
# Failure rate threshold (0.0 to 1.0, e.g., 0.9 = 90% failure rate)
AUTO_DEACTIVATION_FAILURE_RATE=0.9
# Number of recent requests to check for failure rate
AUTO_DEACTIVATION_FAILURE_RATE_WINDOW=50

# Auto-Recovery Configuration
# Automatically reactivate proxies that recover after being deactivated
AUTO_RECOVERY_ENABLED=true
# How often to check deactivated proxies for recovery (in milliseconds)
# Increased to 10 minutes (600000ms) to reduce CPU usage
AUTO_RECOVERY_CHECK_INTERVAL_MS=600000
# Number of consecutive successful requests required to reactivate
AUTO_RECOVERY_CONSECUTIVE_SUCCESSES=5

# IP Rotation Configuration
# Automatically rotate IP for inactive proxies to make them active
IP_ROTATION_ENABLED=true
# How often to check for inactive proxies and trigger IP rotation (in milliseconds)
# Increased to 2 minutes (120000ms) to reduce CPU usage
IP_ROTATION_CHECK_INTERVAL_MS=120000
# Wait time after sending rotation command before checking status (in milliseconds)
IP_ROTATION_WAIT_AFTER_ROTATION_MS=5000
# Cooldown period between rotation attempts for the same proxy (in milliseconds)
IP_ROTATION_COOLDOWN_MS=300000
# Whether to prefer unique IP rotation over standard rotation (true/false)
IP_ROTATION_PREFER_UNIQUE=false
# Periodic IP rotation interval (in milliseconds)
PERIODIC_IP_ROTATION_INTERVAL_MS=600000

# Runtime Configuration
MIN_RUN_HOURS=72
RUN_MODE="infinite"
MONITOR_CHECK_INTERVAL_MS=3600000

# Logging
LOG_LEVEL="info"

# Encryption (for proxy passwords)
# Generate a secure key: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY="your-encryption-key-here-64-hex-characters"
ENCRYPTION_SALT="optional-salt-for-key-derivation"

# Health Check Server
HEALTH_CHECK_PORT=3000

# Data Archival
ENABLE_ARCHIVAL=true
DATA_RETENTION_DAYS=30
ARCHIVAL_INTERVAL_MS=86400000
ARCHIVAL_BATCH_SIZE=1000

# IP Rotation Testing Configuration
# Separate testing flow for IP rotation validation
IP_ROTATION_TESTING_ENABLED=true
# Interval between rotation testing cycles (in milliseconds)
# Set to 15 minutes (900000ms) to reduce CPU usage
IP_ROTATION_TESTING_INTERVAL_MS=900000
# Wait time after rotation before testing (in milliseconds)
IP_ROTATION_TESTING_WAIT_AFTER_ROTATION_MS=10000
# Maximum concurrent operations (reduced to 10 for 2 VCPU systems)
IP_ROTATION_TESTING_CONCURRENCY=10
# Batch size for processing proxies
IP_ROTATION_TESTING_BATCH_SIZE=50

# Alert Monitoring
# Increased to 2 minutes (120000ms) to reduce CPU usage
ENABLE_ALERT_MONITORING=true
ALERT_CHECK_INTERVAL_MS=120000
ALERT_WEBHOOK_URL=""
SLACK_WEBHOOK_URL=""

# Grafana Configuration
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin

# Database Export (optional)
# EXPORT_FORMAT="sql"
# EXPORT_OUTPUT_DIR="./exports"
# EXPORT_TABLES="proxies,proxy_requests"

